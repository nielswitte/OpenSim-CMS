<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>OpenSim-CMS</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Documentation v0.9" />
    <meta name="author" content="OpenSim-CMS">
        <link rel="icon" href="../../img/favicon.png" type="image/x-icon">
        <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>

    <!-- LESS -->
            <style type="text/less">
            @import "../../less/import/daux-base.less";
                        @sidebar-background: #f8f8f8;
                        @sidebar-hover: #e7e7e7;
                        @lines: #e1e1e8;
                        @dark: #333333;
                        @light: #e1e1e8;
                        @text: #000000;
                        @syntax-string: #022e99;
                        @syntax-comment: #84989b;
                        @syntax-number: #428bca;
                        @syntax-label: #840d7a;
                    </style>
        <script src="../../js/less.min.js"></script>
    </head>
<body>
            <!-- Docs -->
                    <a href="https://github.com/nielswitte/OpenSim-CMS" target="_blank" id="github-ribbon" class="hidden-print"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
                <div class="container-fluid fluid-height wrapper">
            <div class="navbar navbar-fixed-top hidden-print">
                <div class="container-fluid">
                    <a class="brand navbar-brand pull-left" href="../../index.html">OpenSim-CMS</a>
                    <p class="navbar-text pull-right">
                        Generated by <a href="http://daux.io">Daux.io</a>
                    </p>
                </div>
            </div>

            <div class="row columns content">
                <div class="left-column article-tree col-sm-3 hidden-print">
                    <!-- For Mobile -->
                    <div class="responsive-collapse">
                        <button type="button" class="btn btn-sidebar" id="menu-spinner-button">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                    <div id="sub-nav-collapse" class="sub-nav-collapse">
                        <!-- Navigation -->
                        <ul class="nav nav-list"><li><a href="#" class="aj-nav folder">Installation</a><ul class="nav nav-list"><li><a href="../../Installation/./Installation.html">Installation</a></li><li><a href="../../Installation/./Assets.html">Assets</a></li><li><a href="../../Installation/./OpenSim.html">OpenSim</a></li></ul></li><li class="open"><a href="#" class="aj-nav folder">API</a><ul class="nav nav-list"><li><a href="../../API/./API.html">API</a></li><li><a href="../../API/./Authentication.html">Authentication</a></li><li><a href="../../API/./Permissions.html">Permissions</a></li><li><a href="../../API/./Users.html">Users</a></li><li><a href="../../API/./Avatars.html">Avatars</a></li><li><a href="../../API/./Groups.html">Groups</a></li><li><a href="../../API/./Chats.html">Chats</a></li><li><a href="../../API/./Meetings.html">Meetings</a></li><li><a href="../../API/./Minutes.html">Minutes</a></li><li><a href="../../API/./Meeting_Rooms.html">Meeting Rooms</a></li><li class="open"><a href="#" class="aj-nav folder">Files</a><ul class="nav nav-list"><li><a href="../../API/Files/./Files.html">Files</a></li><li><a href="../../API/Files/./Documents.html">Documents</a></li><li><a href="../../API/Files/./Presentations.html">Presentations</a></li><li><a href="../../API/Files/./Cache.html">Cache</a></li></ul></li><li><a href="../../API/./Comments.html">Comments</a></li><li><a href="../../API/./Grids.html">Grids</a></li><li><a href="../../API/./Regions.html">Regions</a></li></ul></li><li><a href="#" class="aj-nav folder">CMS</a><ul class="nav nav-list"><li><a href="../../CMS/./CMS.html">CMS</a></li><li><a href="../../CMS/./Login.html">Login</a></li><li><a href="../../CMS/./Dashboard.html">Dashboard</a></li><li><a href="../../CMS/./Grids.html">Grids</a></li><li><a href="../../CMS/./Meetings.html">Meetings</a></li><li><a href="../../CMS/./Documents.html">Documents</a></li><li><a href="../../CMS/./Users_and_Groups.html">Users and Groups</a></li></ul></li><li><a href="../.././FAQ.html">FAQ</a></li></ul>                                            </div>
                </div>
                <div class="right-column  content-area col-sm-9">
                    <div class="content-page">
                        <article>
                                                            <div class="page-header sub-header clearfix">
                                    <h1>Documents                                                                            </h1>
                                        <span style="float: left; font-size: 10px; color: gray;">
                                            Tuesday, April 22, 2014                                        </span>
                                        <span style="float: right; font-size: 10px; color: gray;">
                                            9:59 AM                                        </span>
                                </div>
                                                        <p><strong>NOTICE:</strong> You can only retrieve files if you meet at least one of the following requirements.</p>
<ul>
<li>You have <code>ALL</code> permissions</li>
<li>You created the file</li>
<li>You are a member of a group to which the file is attached</li>
</ul>
<p>The documents API is quite similar to the Files API since it is a subset. The main difference is that it will only return files with the type <code>document</code> and that documents have children in the form of <code>pages</code>.</p>
<pre><code class="language-http">GET /api/documents/ HTTP/1.1</code></pre>
<pre><code class="language-http">GET /api/documents/&lt;OFFSET&gt;/ HTTP/1.1</code></pre>
<h2>Search by title</h2>
<pre><code class="language-http">GET /api/documents/&lt;SEARCH&gt;/ HTTP/1.1</code></pre>
<p>All the above functions will output a list like this:</p>
<pre><code class="language-json">[
    {
        "id": 133,
        "type": "document",
        "user": {
            "id": 3,
            "username": "johndoe",
            "firstName": "John",
            "lastName": "Doe",
            "email": "john@doe.com",
            "picture": false,
            "lastLogin": "2014-04-16 11:17:04"
        },
        "title": "OpenSim-CMS Documentation",
        "creationDate": "2014-04-14 15:55:31",
        "modificationDate": "2014-04-14 15:55:31",
        "sourceFile": "source.pdf",
        "url": "http://localhost:80/OpenSim-CMS/api/document/133/",
        "pagesCount": 22
    },
    { (...) },
    (...)
]</code></pre>
<h2>Get a single document</h2>
<p>When retrieving a sinlg document you will get a lot of information, including a list with all pages and their cache information.</p>
<pre><code class="language-http">GET /api/document/&lt;DOCUMENT-ID&gt;/ HTTP/1.1</code></pre>
<p>For example when retrieving the document with ID 133 you can expect something like this:</p>
<pre><code class="language-json">{
    "id": 133,
    "type": "document",
    "user": {
        "id": 3,
        "username": "johndoe",
        "firstName": "John",
        "lastName": "Doe",
        "email": "john@doe.com",
        "picture": false,
        "lastLogin": "2014-04-16 11:17:04"
    },
    "title": "OpenSim-CMS Documentation",
    "creationDate": "2014-04-14 15:55:31",
    "modificationDate": "2014-04-14 15:55:31",
    "sourceFile": "source.pdf",
    "url": "http://localhost:80/OpenSim-CMS/api/document/133/",
    "pages": [
        {
            "id": 80,
            "number": 1,
            "total": 22,
            "hasComments": false,
            "image": "http://localhost:80/OpenSim-CMS/api/document/133/page/number/1/image/",
            "thumbnail": "http://localhost:80/OpenSim-CMS/api/document/133/page/number/1/thumbnail/",
            "documentTitle": "OpenSim-CMS Documentation",
            "cache": {
                "1": {
                    "uuid": "45e1c4bb-31cd-4b9b-b0a2-720f3f013a6d",
                    "expires": "2014-04-16 15:59:43",
                    "isExpired": 0
                }
            }
        },
        {
            "id": 81,
            "number": 2,
            "total": 22,
            "hasComments": false,
            "image": "http://localhost:80/OpenSim-CMS/api/document/133/page/number/2/image/",
            "thumbnail": "http://localhost:80/OpenSim-CMS/api/document/133/page/number/2/thumbnail/",
            "documentTitle": "OpenSim-CMS Documentation",
            "cache": [

            ]
        },
        { (...) }.
        (...)
    ],
    "pagesCount": 22
}</code></pre>
<h2>Add a new document</h2>
<pre><code class="language-http">POST /api/document/ HTTP/1.1</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>string</td>
<td>The title of the document</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>The document type</td>
</tr>
<tr>
<td>file</td>
<td>file</td>
<td>Base64 encoded file</td>
</tr>
</tbody>
</table>
<h2>Specific document page</h2>
<p>The page details for just one specific page can be accessed through its ID:</p>
<pre><code class="language-http">GET /api/document/&lt;ID&gt;/page/&lt;PAGE-ID&gt;/ HTTP/1.1</code></pre>
<p>However, it is often easier to navigate based on page number:</p>
<pre><code class="language-http">GET /api/document/&lt;ID&gt;/page/number/&lt;PAGE#&gt;/ HTTP/1.1</code></pre>
<p>The given image URL will provide an IMAGE_TYPE of the page resized and centered at IMAGE_WIDTH x IMAGE_HEIGHT with a black or white background.</p>
<pre><code class="language-http">GET /api/document/&lt;ID&gt;/page/number/&lt;PAGE#&gt;/image/ HTTP/1.1</code></pre>
<h2>Cache</h2>
<p>When an page has been processed by OpenSim an UUID is generated for the texture, this UUID can be stored with the page to speed up future use. The cache period (<code>FileCacheTimeout</code>) is set in the <code>FlotsamCache.ini</code> configuration and needs to be matched by the configuration value for the grid in the CMS.</p>
<pre><code class="language-http">PUT /api/document/&lt;ID&gt;/page/number/&lt;PAGE#&gt;/ HTTP/1.1</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>uuid</td>
<td>string</td>
<td>UUID of the page to be saved</td>
</tr>
<tr>
<td>gridId</td>
<td>integer</td>
<td>The ID of the grid, as used in the CMS database</td>
</tr>
</tbody>
</table>                                                    </article>
                    </div>
                </div>
            </div>
        </div>
    


    <!-- hightlight.js -->
    <script src="../../js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Navigation -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
    if (typeof jQuery == 'undefined')
        document.write(unescape("%3Cscript src='../../js/jquery-1.11.0.min.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
        <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/custom.js"></script>
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</body>
</html>
