<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>OpenSim-CMS</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Documentation v0.8" />
    <meta name="author" content="OpenSim-CMS">
        <link rel="icon" href="../../img/favicon.png" type="image/x-icon">
        <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,700,300,100' rel='stylesheet' type='text/css'>

    <!-- LESS -->
            <style type="text/less">
            @import "../../less/import/daux-base.less";
                        @sidebar-background: #f8f8f8;
                        @sidebar-hover: #e7e7e7;
                        @lines: #e1e1e8;
                        @dark: #333333;
                        @light: #e1e1e8;
                        @text: #000000;
                        @syntax-string: #022e99;
                        @syntax-comment: #84989b;
                        @syntax-number: #428bca;
                        @syntax-label: #840d7a;
                    </style>
        <script src="../../js/less.min.js"></script>
    </head>
<body>
            <!-- Docs -->
                    <a href="https://github.com/nielswitte/OpenSim-CMS" target="_blank" id="github-ribbon" class="hidden-print"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
                <div class="container-fluid fluid-height wrapper">
            <div class="navbar navbar-fixed-top hidden-print">
                <div class="container-fluid">
                    <a class="brand navbar-brand pull-left" href="../../index.html">OpenSim-CMS</a>
                    <p class="navbar-text pull-right">
                        Generated by <a href="http://daux.io">Daux.io</a>
                    </p>
                </div>
            </div>

            <div class="row columns content">
                <div class="left-column article-tree col-sm-3 hidden-print">
                    <!-- For Mobile -->
                    <div class="responsive-collapse">
                        <button type="button" class="btn btn-sidebar" id="menu-spinner-button">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>
                    <div id="sub-nav-collapse" class="sub-nav-collapse">
                        <!-- Navigation -->
                        <ul class="nav nav-list"><li><a href="#" class="aj-nav folder">Installation</a><ul class="nav nav-list"><li><a href="../../Installation/./Installation.html">Installation</a></li><li><a href="../../Installation/./Assets.html">Assets</a></li><li><a href="../../Installation/./OpenSim.html">OpenSim</a></li></ul></li><li class="open"><a href="#" class="aj-nav folder">API</a><ul class="nav nav-list"><li><a href="../../API/./API.html">API</a></li><li><a href="../../API/./Authentication.html">Authentication</a></li><li><a href="../../API/./Permissions.html">Permissions</a></li><li><a href="../../API/./Users.html">Users</a></li><li><a href="../../API/./Avatars.html">Avatars</a></li><li><a href="../../API/./Chats.html">Chats</a></li><li><a href="../../API/./Meetings.html">Meetings</a></li><li><a href="../../API/./Minutes.html">Minutes</a></li><li><a href="../../API/./Meeting_Rooms.html">Meeting Rooms</a></li><li class="open"><a href="#" class="aj-nav folder">Files</a><ul class="nav nav-list"><li><a href="../../API/Files/./Files.html">Files</a></li><li><a href="../../API/Files/./Documents.html">Documents</a></li><li><a href="../../API/Files/./Presentations.html">Presentations</a></li><li><a href="../../API/Files/./Cache.html">Cache</a></li></ul></li><li><a href="../../API/./Comments.html">Comments</a></li><li><a href="../../API/./Grids.html">Grids</a></li><li><a href="../../API/./Regions.html">Regions</a></li></ul></li></ul>                                            </div>
                </div>
                <div class="right-column  content-area col-sm-9">
                    <div class="content-page">
                        <article>
                                                            <div class="page-header sub-header clearfix">
                                    <h1>Files                                                                            </h1>
                                        <span style="float: left; font-size: 10px; color: gray;">
                                            Wednesday, April 16, 2014                                        </span>
                                        <span style="float: right; font-size: 10px; color: gray;">
                                            11:23 AM                                        </span>
                                </div>
                                                        <pre><code class="language-http">GET /api/files/ HTTP/1.1
</code></pre>

<pre><code class="language-http">GET /api/files/&lt;OFFSET&gt;/ HTTP/1.1
</code></pre>

<h2>Search</h2>

<p>You can also search for files. This can be done based on Title, User or Avatar.</p>

<h3>Title</h3>

<p>Search for a files by title, at least 3 characters.</p>

<pre><code class="language-http">GET /api/files/&lt;SEARCH&gt;/ HTTP/1.1
</code></pre>

<h3>User</h3>

<p>It is possible to retrieve a list with documents owned by a specific user. This can be done by using the user's ID:</p>

<pre><code class="language-http">GET /api/user/&lt;USER-ID&gt;/files/ HTTP/1.1
</code></pre>

<h3>Avatar</h3>

<p>Or by using an UUID of an avatar linked to the user.</p>

<pre><code class="language-http">GET /api/grid/&lt;GRID-ID&gt;/avatar/&lt;AVATAR-UUID&gt;/files/ HTTP/1.1
</code></pre>

<p>All the above functions will return a similar output, such as the example given below:</p>

<pre><code class="language-json">[
    {
        "id": 134,
        "type": "presentation",
        "user": {
            "id": 4,
            "username": "janedoe",
            "firstName": "Jane",
            "lastName": "Doe",
            "email": "jane@doe.com",
            "picture": "http://localhost:80/OpenSim-CMS/api/user/4/picture/",
            "lastLogin": "2014-04-15 16:00:01"
        },
        "title": "OpenSim-CMS in a nutshell",
        "creationDate": "2014-04-15 09:13:30",
        "modificationDate": "2014-04-15 09:13:30",
        "sourceFile": "source.pdf",
        "url": "http://localhost:80/OpenSim-CMS/api/presentation/134/"
    },
    {
        "id": 133,
        "type": "document",
        "user": {
            "id": 3,
            "username": "johndoe",
            "firstName": "John",
            "lastName": "Doe",
            "email": "john@doe.com",
            "picture": false,
            "lastLogin": "2014-04-16 11:17:04"
        },
        "title": "OpenSim-CMS Documentation",
        "creationDate": "2014-04-14 15:55:31",
        "modificationDate": "2014-04-14 15:55:31",
        "sourceFile": "source.pdf",
        "url": "http://localhost:80/OpenSim-CMS/api/document/133/"
    },
    { (...) },
    (...)
]
</code></pre>

<h2>Get a specific file</h2>

<p>When retrieving a specific file, the output depends on the file type.</p>

<pre><code class="language-http">GET /api/file/&lt;FILE-ID/ HTTP/1.1
</code></pre>

<p>For example if the type is a document it will return the same output as <code>/api/document/&lt;DOCUMENT-ID/</code>, where <code>&lt;FILE-ID&gt;</code> equals <code>&lt;DOCUMENT-ID&gt;</code>.</p>

<h2>Add a new file</h2>

<pre><code class="language-http">POST /api/file/ HTTP/1.1
</code></pre>

<table>
<thead>
<tr>
  <th>Parameter</th>
  <th>Type</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>title</td>
  <td>string</td>
  <td>The title of the document</td>
</tr>
<tr>
  <td>type</td>
  <td>string</td>
  <td>The document type</td>
</tr>
<tr>
  <td>file</td>
  <td>file</td>
  <td>Base64 encoded file</td>
</tr>
</tbody>
</table>

<h2>Remove a file</h2>

<pre><code class="language-http">DELETE /api/file/&lt;FILE-ID&gt;/ HTTP/1.1
</code></pre>

<h2>Images</h2>

<p>The image of file with type <code>image</code> can be retrieved by using the following API function</p>

<pre><code class="language-http">GET /api/file/&lt;FILE-ID&gt;/image/ HTTP/1.1
</code></pre>

<h2>Source file</h2>

<p>Retrieve the original file uploaded before being processed by the API.</p>

<pre><code class="language-http">GET /api/file/&lt;FILE-ID&gt;/source/ HTTP/1.1
</code></pre>

<p>Or for presentations this alias could be used:</p>

<pre><code class="language-http">GET /api/presentation/&lt;PRESENTATION-ID&gt;/source/ HTTP/1.1
</code></pre>

<p>Or a document</p>

<pre><code class="language-http">GET /api/document/&lt;DOCUMENT-ID&gt;/source/ HTTP/1.1
</code></pre>

<h2>Cache</h2>

<p>When an image has been processed by OpenSim an UUID is generated for the texture, this UUID can be stored with the slide to speed up future use. The cache period (<code>FileCacheTimeout</code>) is set in the <code>FlotsamCache.ini</code>  configuration and needs to be matched by the configuration value for the grid in the CMS.</p>

<pre><code class="language-http">PUT /api/file/&lt;ID&gt;/image/ HTTP/1.1
</code></pre>

<table>
<thead>
<tr>
  <th>Parameter</th>
  <th>Type</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>uuid</td>
  <td>string</td>
  <td>UUID of the slide to be saved</td>
</tr>
<tr>
  <td>gridId</td>
  <td>integer</td>
  <td>The ID of the grid, as used in the CMS database</td>
</tr>
</tbody>
</table>
                                                    </article>
                    </div>
                </div>
            </div>
        </div>
    


    <!-- hightlight.js -->
    <script src="../../js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Navigation -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
    if (typeof jQuery == 'undefined')
        document.write(unescape("%3Cscript src='../../js/jquery-1.11.0.min.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
        <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/custom.js"></script>
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</body>
</html>
